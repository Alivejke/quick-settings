'use strict';

angular.module('app', ['app.services', 'app.controllers', 'app.directives']);'use strict';

angular.module('app.controllers', ['app.services', 'ngAnimate'])
    .controller('QuickSettingsCtrl', ['$scope', 'quickSettings', '$timeout', function($scope, quickSettings, $timeout) {
        $scope.avaliableSettings = quickSettings.avaliableSettings;
        $scope.activeSettings = quickSettings.activeSettings;
        $scope.animationBlock = false;

        $scope.currentTime = (new Date).getTime();

        function unblockAnimation (delay) {
            $timeout(function() {
                $scope.animationBlock = false;
            }, delay);
        }

        $scope.settingsSlideUp = function() {
            if($scope.animationBlock) return;
            $scope.animationBlock = true;

            var popped = angular.copy($scope.avaliableSettings[$scope.avaliableSettings.length - 1]);            
            $scope.avaliableSettings.unshift(popped);


            $timeout(function () {
                $scope.avaliableSettings.pop();
                unblockAnimation(500);
            }, 0);
        };

        $scope.settingsSlideDown = function() {
            if($scope.animationBlock) return;
            $scope.animationBlock = true;

            var shifted = angular.copy( $scope.avaliableSettings[0] );            
            $scope.avaliableSettings.shift();

            $timeout(function () {
                $scope.avaliableSettings.push(shifted);
                unblockAnimation(500);
            }, 0);
        };

    }]);'use strict';


angular.module('app.directives', [])
    .directive('ngEnter', function () {
        return function (scope, element, attrs) {
            element.bind('keydown keypress', function (event) {
                if(event.which === 13) {
                    scope.$apply(function (){
                        scope.$eval(attrs.ngEnter);
                    });

                    event.preventDefault();
                }
            });
        };
    });'use strict';
'use strict';

angular.module('app.services', ['LocalStorageModule'])
    .factory('quickSettings', ['localStorageService', function(lsService) {
        var factory = {},
            callSign = 'WSCBS',
            channelNumber = 2,
            activeSettings = lsService.get('quickSettings'),
            avaliableSettings = [
                {
                    name: 'recording',
                    textEnabled: 'Stop recording ' + callSign + ' ' + channelNumber + ' now',
                    textDisabled:'Start recording ' + callSign + ' ' + channelNumber + ' now'
                },
                {
                    name: 'favoriteChannel',
                    textEnabled: 'Remove ' + callSign + ' ' + channelNumber + ' from Favorites List',
                    textDisabled:'Add ' + callSign + ' ' + channelNumber + ' to Favorites List'
                },
                {
                    name: 'language',
                    text: 'Choose SAP language',
                    items: ['English', 'Español', 'Français'],
                    type: 'slider'
                },
                {
                    name: 'sleepTimer',
                    text: 'Set Sleep Timer  (minutes)',
                    items: ['OFF', 5, 15, 30, 45, 60, 75, 90, 105, 120, 180, 240],
                    type: 'slider',
                    showCurrent: true
                },
                {
                    name: 'parentalControl',
                    textEnabled: 'Turn OFF Parental Control',
                    textDisabled: 'Turn ON Parental Control'
                }
            ];

        factory.setSettings = function(settings) {
            lsService.set('quickSettings', settings);
        }

        // Returns last saved settings
        factory.getLastSettings = function() {
            return lsService.get('quickSettings');
        }

        if(!activeSettings) {
            activeSettings = {
                recording: {
                    active: false
                },
                favoriteChannel: {
                    active: false
                },
                language: {
                    active: 'English'
                },
                sleepTimer: {
                    active: 'OFF',
                    timestamp: null
                },
                parentalControl: {
                    active: false
                }
            };

            factory.setSettings(activeSettings);
        }

        factory.activeSettings = activeSettings;

        factory.avaliableSettings = avaliableSettings;

        return factory;
    }]);